<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Solar power and ROI calculator</title>
<link rel="icon" href="https://yeabsira8.github.io/solar-power-calculator/dynamic logo1.png">
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.js"></script>
<script src="index.js"> </script>
<link rel="stylesheet" href="style.css">
<style>



#map {   
  position: absolute;
  bottom: 60px;
  left: 1.5%;
  width: 500px;
  height: 300px;
  display: block;
  border-radius: 12px;
   }
</style>
</head>
<script type="text/javascript" src="https://yeabsira8.github.io/solar-power-calculator/js/scratch_14.js"></script>
<div class="topnav">
  <a class="active" id="home">Solar Power calculator</a>

</div>
<body>
<style>

#calculated-area {

  color:black;
  margin-top: 5%;

    }



    .calculation-box {
        height: 40px;
        width: 130px;
        position: absolute;
        bottom: 280px;
        left: 2%;
        background-color: rgba(255, 255, 255, 0.9);
        padding: 15px;
        text-align: center;
        border-radius: 12px;
        background-color: #EFEFEF;
    }

    p {
        font-family: 'Open Sans';
        margin: 0;
        font-size: 13px;
    }

    
</style>

<script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.css" type="text/css">
<form name="myForm">
<div class="form">
        <br>
        <label class="form-label"> Please enter your rooftop area: </label>
        <br>
        <p class="guide"> (Please use the map tool below if you don't know your rooftop area)</p>
      <input type="number" min="10" maxlength="3" class="form-input" name="area" placeholder="Type your area (m2)" id="area"><br>
      <br>
      <label class="form-label">Please enter your last <strong>month</strong> electricity bill: </label>
        <input type="number" class="form-input" name="bill" placeholder="Type your bill (€) " id="bill">
      <br>
      <br>
      <input class="button" id="calculate" value="calculate" type="button" onclick="showResult()">
</div>

<br>
  </form>
     <div class="results" id="answers22">
     <h2 class="h2"> <strong> Results </strong></h2>
     <div class="ans1">
       <p class="result">Number of panels: <strong style="color: green" id="Number_of_panels_needed"></strong> </p>
       <p class="result"> Solar Capacity: <strong style="color: green" id="capacity"></strong> </p>
       <p class="result"> Estimated Annual solar power generation: <strong style="color: green" id="generation"></strong> </p>
       <p class="result"> Estimated Total cost: <strong style="color: green" id="e_cost"></strong>  </p>
    </div>
     <br>
     <br>
     <div class="ans">
       <p class="result"> Annual savings: <strong style="color: green" id="saving"></strong></p>
       <p class="result"> Payoff Period: <strong style="color: green" id="payoff"></strong> </p>
       <p class="result"> ROI: <strong style="color: green" id="ROI"></strong>  </p>
       <br>
     
    </div>
         <button  id="quote" > </button>

</div>



<div id="map"></div>
<div class="calculation-box">
<p id="calculated-map">Your rooftop area:  </p>
<div id="calculated-area"></div>
</div>

<script>
  
mapboxgl.accessToken = 'pk.eyJ1IjoieWVhYnNpcmEtOCIsImEiOiJjbGF3bzVzb3EwOTRpM3FwN2R5dGNnbmtvIn0.fyW0LX5GSP5b-K_b4AT_Ow';
const map = new mapboxgl.Map({
container: 'map', // container ID
// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
style: 'mapbox://styles/mapbox/satellite-v9', // style URL
center: [-91.874, 42.76], // starting position [lng, lat]
zoom: 12 // starting zoom
});
 
const draw = new MapboxDraw({
displayControlsDefault: false,
// Select which mapbox-gl-draw control buttons to add to the map.
controls: {
polygon: true,
trash: true
},
// Set mapbox-gl-draw to draw by default.
// The user does not have to click the polygon control button first.
defaultMode: 'draw_polygon'
});
map.addControl(draw);
 
map.on('draw.create', updateArea);
map.on('draw.delete', updateArea);
map.on('draw.update', updateArea);
 
function updateArea(e) {
const data = draw.getAll();
const answer = document.getElementById('calculated-area');
if (data.features.length > 0) {
const area = turf.area(data);
// Restrict the area to 2 decimal points.
const rounded_area = Math.round(((area * 100) / 100),0);
answer.innerHTML = `<p><strong>${rounded_area}</strong></p><p id="m2">square meters</p>`;


} else {
answer.innerHTML = '';
if (e.type !== 'draw.delete')
alert('Click the map to draw a polygon.');
}
}

// Add geolocate control to the map.
map.addControl(
new mapboxgl.GeolocateControl({
positionOptions: {
enableHighAccuracy: true
},
// When active the map will receive updates to the device's location as it changes.
trackUserLocation: true,
// Draw an arrow next to the location dot to indicate which direction the device is heading.
showUserHeading: true
})
);



function showResult() {

  
  
var area1=document.myForm.area.value;



var area1=document.myForm.bill.value;

if (area1==null || area1==""){
alert("please type your bill");
return false;
}


var panel_efficiency = 0.18;
var H = 1000;
var PR = 0.75;
var area222 = document.getElementById("area").value;
var area201 = (area222*0.75);
var panels = Math.round((area201)/1.64);

Number_of_panels_needed.innerHTML=Math.round((area201)/1.64);

capacity.innerHTML= Math.round(panels*295/1000)+ " kW";

var bill = document.getElementById("bill").value;
generation.innerHTML= Math.round(area201*panel_efficiency*H*PR/1000)+ " MWh";
var savings = Math.round(bill*12);
var parts = savings.toString().split(".");
var num = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",") + (parts[1] ? "." + parts[1] : "");
saving.innerHTML=num + " €";

var savings = (bill*12);
var costs = ((panels*295)*2);

payoff.innerHTML = Math.round(costs / savings) + " years";
var cost = Math.round(costs);
var parts = cost.toString().split(".");
var num1 = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",") + (parts[1] ? "." + parts[1] : "");
e_cost.innerHTML = num1 + " €";

ROI.innerHTML = Math.round((((25*savings)-costs)/costs)*100)+ " % over lifetime";

var quote1 = "Get Solar Quote";

quote.innerHTML = quote1;

var x = document.getElementById("answers22");
    x.style.display = "block";

}


</script>

</body>
</html>